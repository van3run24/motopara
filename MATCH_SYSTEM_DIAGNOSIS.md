# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã –º—ç—Ç—á–µ–π

## üîç –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–∏–∫–∏ –º—ç—Ç—á–µ–π

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

1. **–°–æ–∑–¥–∞–Ω–∏–µ –º—ç—Ç—á–∞:**
   - `recordLike()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∑–∞–∏–º–Ω–æ—Å—Ç—å –ª–∞–π–∫–æ–≤
   - –ü—Ä–∏ –≤–∑–∞–∏–º–Ω–æ–º –ª–∞–π–∫–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è —á–∞—Ç —á–µ—Ä–µ–∑ `createChat()`
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `{ isMatch: true, chat }`

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –º—ç—Ç—á–∞ –≤ UI:**
   - –ù–æ–≤—ã–π —á–∞—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ `setChats()`
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ `setNewMatches()` —Å `isNew: true`
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º –º—ç—Ç—á–µ

3. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º—ç—Ç—á–µ–π:**
   - –û—Ç–¥–µ–ª—å–Ω–∞—è —Å–µ–∫—Ü–∏—è "–ù–æ–≤—ã–µ –º—ç—Ç—á–∏" –Ω–∞–¥ —Å–ø–∏—Å–∫–æ–º —á–∞—Ç–æ–≤
   - –û—Ä–∞–Ω–∂–µ–≤–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –∏ –±–µ–π–¥–∂ "new"
   - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞ –∏–∫–æ–Ω–∫–µ —á–∞—Ç–æ–≤

### ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

#### 1. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏**
–ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –Ω–æ–≤—ã–π –º—ç—Ç—á –≤ —Å–µ–∫—Ü–∏–∏ "–ù–æ–≤—ã–µ –º—ç—Ç—á–∏":
```javascript
// –°–æ–∑–¥–∞–µ—Ç—Å—è –µ—â–µ –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç —á–∞—Ç–∞
const newChat = { 
  id: Date.now(), // –í–†–ï–ú–ï–ù–ù–´–ô ID!
  name: match.name, 
  // ...
};
```
**–ü—Ä–æ–±–ª–µ–º–∞:** `id: Date.now()` –º–æ–∂–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º ID —á–∞—Ç–∞ –∏–∑ –±–∞–∑—ã

#### 2. **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ ID**
- –í `newMatches` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `match.id` (ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- –í `chats` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `chat.id` (ID —á–∞—Ç–∞)
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: `m.id === chat.id || m.name === chat.name`

#### 3. **Real-time —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**
–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –º—ç—Ç—á–∞ —É –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤—Ç–æ—Ä–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∏—Ç—å:
- Real-time —Å–æ–±—ã—Ç–∏–µ –æ –Ω–æ–≤–æ–º —á–∞—Ç–µ
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —á–∞—Ç–æ–≤
- –ü–æ—è–≤–ª–µ–Ω–∏–µ –≤ "–ù–æ–≤—ã—Ö –º—ç—Ç—á–∞—Ö"

### üîß –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

#### 1. **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å ID —Å–∏—Å—Ç–µ–º—É**
```javascript
// –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –º—ç—Ç—á–∞
setNewMatches(prev => [{...likedUser, chatId: newChat.id, isNew: true}, ...prev]);

// –ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ
const isNewMatch = newMatches.some(m => m.chatId === chat.id && m.isNew);
```

#### 2. **–£–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Ç–æ–≤**
```javascript
// –ù–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π —á–∞—Ç –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –Ω–æ–≤—ã–π –º—ç—Ç—á
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —á–∞—Ç –∏–∑ —Å—Ç–µ–π—Ç–∞
const existingChat = chats.find(c => c.name === match.name);
if (existingChat) {
  openChat(existingChat);
  setNewMatches(prev => prev.map(m => m.id === match.id ? {...m, isNew: false} : m));
}
```

#### 3. **–£–ª—É—á—à–∏—Ç—å real-time –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**
```javascript
// –í real-time –ø–æ–¥–ø–∏—Å–∫–µ –Ω–∞ —á–∞—Ç—ã
if (payload.new.participant_1_id === userId || payload.new.participant_2_id === userId) {
  // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å ID –ø–∞—Ä—Ç–Ω–µ—Ä–∞
  const partnerId = payload.new.participant_1_id === userId ? 
    payload.new.participant_2_id : payload.new.participant_1_id;
  
  // –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ newMatches
  const { data: partner } = await supabase
    .from('users')
    .select('name, image, images')
    .eq('id', partnerId)
    .single();
    
  if (partner) {
    setNewMatches(prev => [{...partner, chatId: payload.new.id, isNew: true}, ...prev]);
  }
}
```

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:

### –¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ –º—ç—Ç—á–∞
1. –î–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ª–∞–π–∫–∞—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞
2. **–û–∂–∏–¥–∞–Ω–∏–µ:** –£ –æ–±–æ–∏—Ö –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–π –º—ç—Ç—á –≤ "–ù–æ–≤—ã—Ö –º—ç—Ç—á–∞—Ö"
3. **–û–∂–∏–¥–∞–Ω–∏–µ:** –ß–∞—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ —á–∞—Ç–æ–≤ —Å –æ—Ä–∞–Ω–∂–µ–≤–æ–π –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π

### –¢–µ—Å—Ç 2: Real-time —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ê –ª–∞–π–∫–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë (—É –ë —É–∂–µ –µ—Å—Ç—å –ª–∞–π–∫)
2. **–û–∂–∏–¥–∞–Ω–∏–µ:** –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë —Å—Ä–∞–∑—É –ø–æ—è–≤–ª—è–µ—Ç—Å—è –º—ç—Ç—á
3. **–û–∂–∏–¥–∞–Ω–∏–µ:** –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ê –ø–æ—è–≤–ª—è–µ—Ç—Å—è –º—ç—Ç—á –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è

### –¢–µ—Å—Ç 3: –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –Ω–æ–≤—ã—Ö –º—ç—Ç—á–µ–π
1. –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –Ω–æ–≤—ã–π –º—ç—Ç—á –≤ —Å–µ–∫—Ü–∏–∏ "–ù–æ–≤—ã–µ –º—ç—Ç—á–∏"
2. **–û–∂–∏–¥–∞–Ω–∏–µ:** –ú—ç—Ç—á –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑ "–ù–æ–≤—ã—Ö –º—ç—Ç—á–µ–π"
3. **–û–∂–∏–¥–∞–Ω–∏–µ:** –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –≤ —á–∞—Ç–∞—Ö –æ—Å—Ç–∞–µ—Ç—Å—è –¥–æ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:
- ‚úÖ –ë–∞–∑–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ö†Ô∏è –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å ID –∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚ö†Ô∏è Real-time –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- üîß –ù—É–∂–Ω—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã
