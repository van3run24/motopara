# Развертывание групповых чатов событий

## Что нужно сделать:

### 1. ✅ Выполнить SQL миграцию

**Если поле max_participants еще НЕ добавлено:**
Выполните SQL из файла `create_event_chat_tables.sql` в Supabase SQL Editor.

**Если поле УЖЕ добавлено с DEFAULT 50:**
Выполните SQL из файла `update_max_participants.sql` чтобы:
- Удалить значение по умолчанию
- Сделать поле nullable  
- Обновить существующие записи

```sql
-- Весь SQL код из файла
```

### 2. ✅ Проверить код
Код уже добавлен:
- EventGroupChat компонент
- Кнопка "Присоединиться к чату" в событиях
- Функции для работы с групповыми чатами
- Лимиты участников

### 3. ✅ Развернуть изменения
```bash
git add .
git commit -m "Add group chat functionality for events"
git push origin main
```

## Как это работает:

### При создании события:
- Автоматически создается групповой чат (триггер в БД)
- Создатель события автоматически добавляется в чат
- Можно установить максимальное количество участников (опционально)
- Если поле пустое - лимитов нет

### Присоединение к чату:
- Пользователь нажимает "Присоединиться к чату"
- Проверяется лимит участников (только если указан)
- Добавляется в участники если есть место
- Показывается информация о количестве участников

### В групповом чате:
- Имя показывается только над первым сообщением подряд
- Поддерживаются текст и изображения
- Системные уведомления о входе/выходе

## Фичи:
- ✅ Автоматическое создание чата при создании события
- ✅ Кнопка присоединения в карточке события
- ✅ Опциональный лимит участников
- ✅ Отображение текущего/максимального количества
- ✅ Группировка сообщений по отправителям (как в Telegram)
- ✅ Поддержка изображений в групповых чатах
- ✅ Real-time обновления
- ✅ Системные уведомления
- ✅ Индикация загрузки при присоединении

## Лимиты и оптимизация:
- Изображения сжимаются перед загрузкой
- Кэширование на 24 часа
- RLS политики безопасности
- Проверка лимита участников перед входом
- Опциональное ограничение количества участников

Готово к тестированию!
